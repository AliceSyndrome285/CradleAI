# 全局设置指南

## 1. 全局设置概述

全局设置提供了一种强大的方式来设置和管理应用程序的核心行为。通过全局设置，您可以:

- 创建和管理适用于所有角色的预设提示词
- 建立和维护全局世界书数据库
- 配置全局正则表达式脚本，用于自动处理输入和输出文本

本指南将帮助您理解如何有效使用这些功能来增强您与AI角色的互动体验。

## 2. 界面概览

全局设置页面分为三个主要标签页:

![全局设置界面](../assets/docs/global_settings_ui.png)

1. **全局预设**: 管理适用于所有角色的系统指令和提示词
2. **全局世界书**: 创建和维护可在所有角色间共享的知识库
3. **全局正则**: 配置文本处理规则，自动修改输入和输出内容

每个标签页都有其独特的功能和设置选项，允许您精细控制应用程序的行为。

## 3. 全局预设

全局预设允许您设置适用于所有角色的系统指令和提示词，为所有角色提供一致的基础行为模式。

### 3.1 启用与切换

在全局预设标签页的顶部，您可以:

- **启用/禁用全局预设**: 通过开关控制全局预设的应用状态
- **选择预设模板**: 从下拉菜单中选择不同的预设模板
- **创建新模板**: 点击复制图标创建新的预设模板
- **重命名模板**: 在下拉菜单中点击铅笔图标重命名模板
- **删除模板**: 点击垃圾桶图标删除当前选中的模板

> **注意**: 关闭全局预设后，需在角色卡详情页面重新设置和保存单角色的预设。

### 3.2 预设条目管理

预设条目部分允许您管理构成预设的各个指令:

#### 3.2.1 视图切换

- **紧凑视图/详细视图**: 点击列表/网格图标在两种视图模式间切换
- **显示/隐藏禁用条目**: 点击眼睛图标控制是否显示被禁用的条目

#### 3.2.2 条目操作

- **添加条目**: 点击加号图标添加新的预设条目
- **编辑条目**: 点击任意条目打开详情侧边栏进行编辑
- **排序条目**: 使用上下箭头按钮调整条目顺序
- **启用/禁用条目**: 在紧凑视图中点击对勾/叉号图标切换条目状态

#### 3.2.3 批量管理

- **进入管理模式**: 点击扳手图标进入批量管理模式
- **选择多个条目**: 勾选要操作的条目
- **批量删除**: 点击"删除选中条目"按钮删除所有选中的条目

#### 3.2.4 导入导出

- **导入预设**: 点击下载图标从JSON文件导入预设
- **创建模板**: 点击复制图标创建新的预设模板

### 3.3 预设条目详情编辑

点击任何预设条目后，侧边栏将打开，允许您编辑以下内容:

- **名称**: 条目的描述性标题
- **内容**: 条目的实际提示词文本
- **启用状态**: 控制条目是否生效
- **角色**: 设置为"用户"或"AI"
- **插入类型**: 选择"对话式"或"相对位置"
- **深度**: 当使用"对话式"插入时，设置深度值

## 4. 全局世界书

全局世界书功能允许您创建一个共享的知识库，可以应用于所有角色对话。

### 4.1 基本设置

全局世界书页面顶部提供以下控制选项:

- **启用/禁用全局世界书**: 通过开关控制全局世界书的应用状态
- **选择世界书模板**: 从下拉菜单中选择不同的世界书模板
- **优先级设置**: 选择"全局优先"或"角色优先"，决定当角色有自己的世界书时如何处理冲突

### 4.2 世界书条目管理

世界书条目部分允许您管理构成世界书的各个知识点:

#### 4.2.1 视图切换

- **紧凑视图/详细视图**: 点击列表/网格图标在两种视图模式间切换
- **显示/隐藏禁用条目**: 点击眼睛图标控制是否显示被禁用的条目

#### 4.2.2 条目操作

- **添加条目**: 点击加号图标添加新的世界书条目
- **编辑条目**: 点击任意条目打开详情侧边栏进行编辑
- **排序条目**: 使用上下箭头按钮调整条目顺序
- **启用/禁用条目**: 在紧凑视图中点击对勾/叉号图标切换条目状态

#### 4.2.3 批量管理

- **进入管理模式**: 点击扳手图标进入批量管理模式
- **选择多个条目**: 勾选要操作的条目
- **批量删除**: 点击"删除选中条目"按钮删除所有选中的条目

#### 4.2.4 导入导出

- **导入世界书**: 点击下载图标从JSON文件导入世界书
- **创建模板**: 点击复制图标创建新的世界书模板

### 4.3 世界书条目详情编辑

点击任何世界书条目后，侧边栏将打开，允许您编辑以下内容:

- **名称**: 条目的描述性标题（对应世界书中的comment字段）
- **内容**: 条目的实际知识内容
- **禁用**: 控制条目是否生效
- **常量**: 设置条目是否为常量（始终包含）
- **位置**: 设置条目的插入位置
- **深度**: 设置条目的深度值

## 5. 全局正则

全局正则脚本功能允许您创建文本处理规则，自动修改用户输入和AI输出。

### 5.1 基本设置

全局正则页面顶部提供以下控制选项:

- **启用/禁用全局正则**: 通过开关控制全局正则脚本的应用状态
- **选择脚本组**: 从下拉菜单中选择不同的脚本组

### 5.2 脚本组管理

脚本组功能允许您将相关的正则脚本组织到一起:

- **创建脚本组**: 点击文件夹图标创建新的脚本组
- **重命名脚本组**: 在下拉菜单中点击铅笔图标重命名脚本组
- **删除脚本组**: 点击垃圾桶图标删除当前选中的脚本组
- **绑定特定角色**: 点击人物图标将脚本组绑定到当前角色
- **绑定所有角色**: 点击星形图标将脚本组应用于所有角色

### 5.3 正则脚本管理

正则脚本部分允许您管理构成脚本组的各个脚本:

#### 5.3.1 视图切换

- **紧凑视图/详细视图**: 点击列表/网格图标在两种视图模式间切换

#### 5.3.2 脚本操作

- **添加脚本**: 点击复制图标添加新的正则脚本
- **编辑脚本**: 点击任意脚本打开详情侧边栏进行编辑
- **启用/禁用脚本**: 点击对勾/叉号图标切换脚本状态
- **测试脚本**: 点击烧杯图标测试当前所有启用的脚本

#### 5.3.3 批量管理

- **进入管理模式**: 点击扳手图标进入批量管理模式
- **选择多个脚本**: 勾选要操作的脚本
- **批量删除**: 点击"删除选中脚本"按钮删除所有选中的脚本

#### 5.3.4 导入导出

- **导入脚本**: 点击下载图标从JSON文件导入正则脚本

### 5.4 正则脚本详情编辑

点击任何正则脚本后，侧边栏将打开，允许您编辑以下内容:

- **名称**: 脚本的描述性标题
- **查找正则表达式**: 用于匹配文本的正则表达式
- **替换文本**: 用于替换匹配文本的内容
- **正则标志**: 设置如g（全局）、i（不区分大小写）等标志
- **作用范围**: 选择应用于"用户输入"和/或"AI输出"
- **高级选项**:
  - **禁用**: 控制脚本是否生效
  - **仅Markdown**: 脚本是否仅应用于Markdown内容
  - **仅提示词**: 脚本是否仅应用于提示词
  - **编辑时运行**: 是否在编辑时运行脚本
  - **替换正则**: 替换方式设置
  - **最小/最大深度**: 应用脚本的深度范围

## 6. 使用技巧与最佳实践

### 6.1 全局预设使用技巧

- **创建基础模板**: 为不同类型的对话创建不同的基础预设模板
- **优先级设置**: 将最重要的指令放在列表顶部
- **避免冲突**: 确保全局预设与角色特定预设不会产生冲突
- **定期更新**: 根据与AI的互动体验定期调整和优化预设内容

### 6.2 全局世界书使用技巧

- **分类组织**: 将相关知识点组织在同一个世界书模板中
- **优先级明确**: 使用"全局优先"或"角色优先"明确设置冲突解决策略
- **常量知识**: 将普遍适用的事实设为常量
- **深度控制**: 为不同重要程度的知识点设置不同深度

### 6.3 全局正则使用技巧

- **分组管理**: 将相关功能的脚本放在同一个脚本组中
- **角色绑定**: 为特定角色创建专属的脚本组
- **测试验证**: 使用测试功能验证脚本效果
- **标志设置**: 正确设置正则表达式标志以获得预期效果
- **作用域限制**: 明确设置脚本应用于用户输入还是AI输出

## 7. 保存与应用

完成全局设置的配置后，您需要点击页面底部的"保存设置"按钮使更改生效。保存后，根据您的设置:

- 全局预设将应用于所有角色对话（如启用）
- 全局世界书将与角色特定世界书结合（如启用）
- 全局正则脚本将自动处理文本输入和输出（如启用）

请注意，某些设置更改可能需要重新开始对话才能完全生效。
